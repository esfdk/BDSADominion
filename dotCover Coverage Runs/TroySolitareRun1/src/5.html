<html>
	<head>
		<script type="text/javascript" src="../js/coverreport.js">

		</script><script type="text/javascript">
			RANGES_5 = [
   [174,9,174,27,'dccv']
, [176,13,176,44,'dccv']
, [177,13,177,48,'dccv']
, [178,13,178,50,'dccv']
, [179,13,179,44,'dccv']
, [180,13,180,48,'dccv']
, [181,13,181,125,'dccv']
, [182,13,182,47,'dccv']
, [183,9,183,10,'dccv']
, [212,13,212,59,'dccv']
, [214,13,214,61,'dccv']
, [215,13,215,66,'dccv']
, [216,13,216,68,'dccv']
, [217,13,217,62,'dccv']
, [218,13,218,73,'dccv']
, [219,13,219,30,'dccv']
, [220,13,220,27,'dccv']
, [221,13,221,28,'dccv']
, [222,13,222,32,'dccv']
, [223,13,223,32,'dccv']
, [224,13,224,31,'dccv']
, [225,13,225,28,'dccv']
, [226,13,226,36,'dccv']
, [228,39,228,71,'dccv']
, [228,22,228,35,'dccv']
, [230,17,230,60,'dccv']
, [231,17,231,81,'dccv']
, [232,17,232,82,'dccv']
, [233,17,233,51,'dccv']
, [228,36,228,38,'dccv']
, [236,39,236,71,'dccv']
, [236,22,236,35,'dccv']
, [238,17,238,72,'dccv']
, [240,21,240,81,'dccv']
, [241,21,241,86,'dccv']
, [242,21,242,57,'dccv']
, [236,36,236,38,'dccv']
, [246,13,246,56,'dccv']
, [247,13,247,58,'dccv']
, [248,9,248,10,'dccv']
, [265,13,265,61,'dccv']
, [267,17,267,37,'dccv']
, [268,17,268,31,'dccv']
, [271,13,271,48,'dccv']
, [272,13,272,50,'dccv']
, [274,13,274,42,'dccv']
, [275,13,275,42,'dccv']
, [277,13,277,122,'dccv']
, [279,17,279,65,'dccv']
, [281,21,281,89,'dccv']
, [284,17,284,67,'dccv']
, [286,21,286,93,'dccv']
, [289,17,289,86,'dccv']
, [291,21,291,39,'dccv']
, [296,13,296,87,'dccv']
, [301,13,301,35,'dccv']
, [302,9,302,10,'dccv']
, [310,13,310,65,'dccv']
, [311,13,311,33,'dccv']
, [312,13,312,64,'dccv']
, [314,13,314,45,'dccv']
, [315,13,315,47,'dccv']
, [316,13,316,48,'dccv']
, [317,13,317,45,'dccv']
, [318,13,318,47,'dccv']
, [319,13,319,82,'dccv']
, [320,13,320,80,'dccv']
, [321,13,321,120,'dccv']
, [322,13,322,114,'dccv']
, [323,13,323,116,'dccv']
, [324,13,324,118,'dccv']
, [325,13,325,130,'dccv']
, [326,13,326,33,'dccv']
, [328,17,328,101,'dccv']
, [331,13,331,33,'dccv']
, [333,17,333,98,'dccv']
, [336,13,336,68,'dccv']
, [338,17,338,124,'dccv']
, [341,13,341,68,'dccv']
, [346,13,346,31,'dccv']
, [347,13,347,33,'dccv']
, [348,9,348,10,'dccv']
, [32,9,32,106,'dccv']
, [37,9,37,108,'dccv']
, [256,9,256,10,'dcuc']
, [298,17,298,29,'dcuc']
, [343,17,343,138,'dcuc']
];
		</script><link rel="stylesheet" type="text/css" href="../css/coverreport.css" />
	</head><body>
		<code id="src5" class="dotCoverSource"><pre>namespace BDSADominion.GUI
{
    using System;
    using System.Collections.Generic;

    using BDSADominion.GUI.Sprites;

    using Gamestate;
    using Microsoft.Xna.Framework;
    using Microsoft.Xna.Framework.Graphics;
    using Microsoft.Xna.Framework.Input;
    using Zones;

    /// &lt;summary&gt;
    /// This is the main type for your game.
    /// &lt;/summary&gt;
    /// &lt;author&gt;
    /// Frederik Lysgaard (frly@itu.dk)
    /// &lt;/author&gt;
    public class GameClass : Game
    {
        #region // Fields\\

        /// &lt;summary&gt;
        /// backsprite used to show backside of card.
        /// &lt;/summary&gt;
        public static CardSprite Back;

        /// &lt;summary&gt;
        /// A dictionary containing a cardmember and the corresponding cardtexture.
        /// &lt;/summary&gt;
        public static Dictionary&lt;CardName, Texture2D&gt; CardImages = new Dictionary&lt;CardName, Texture2D&gt;();

        /// &lt;summary&gt;
        /// A dictionary containing a cardmember and the corresponding buttontexture.
        /// &lt;/summary&gt;
        public static Dictionary&lt;CardName, Texture2D&gt; ButtonImages = new Dictionary&lt;CardName, Texture2D&gt;();

        /// &lt;summary&gt;
        /// emptysprite used to show an emptyspot.
        /// &lt;/summary&gt;
        public static CardSprite Empty;

        /// &lt;summary&gt;
        /// The Discardzone.
        /// &lt;/summary&gt;
        internal readonly DiscardZone DiscardZone;

        /// &lt;summary&gt;
        /// The Deckzone.
        /// &lt;/summary&gt;
        internal readonly DeckZone DeckZone;

        /// &lt;summary&gt;
        /// The ActionZone.
        /// &lt;/summary&gt;
        internal readonly ActionZone ActionZone;

        /// &lt;summary&gt;
        /// The Handzone.
        /// &lt;/summary&gt;
        internal readonly HandZone HandZone;

        /// &lt;summary&gt;
        /// The Supplyzone.
        /// &lt;/summary&gt;
        internal readonly SupplyZone SupplyZone;

        /// &lt;summary&gt;
        /// Number of actions left.
        /// &lt;/summary&gt;
        internal int Actions;

        /// &lt;summary&gt;
        /// Number of buys left.
        /// &lt;/summary&gt;
        internal int Buys;

        /// &lt;summary&gt;
        /// Number of extra coins.
        /// &lt;/summary&gt;
        internal int Coins;

        /// &lt;summary&gt;
        /// The Graphicsmanager for the game.
        /// &lt;/summary&gt;
        readonly GraphicsDeviceManager graphics;

        /// &lt;summary&gt;
        /// indicate the players number.
        /// &lt;/summary&gt;
        internal int Playernum;

        /// &lt;summary&gt;
        /// Indicate player turn.
        /// &lt;/summary&gt;
        internal bool Turn;

        /// &lt;summary&gt;
        /// Indicate phase.
        /// &lt;/summary&gt;
        internal int Phase;

        /// &lt;summary&gt;
        /// Indicates if games is over.
        /// &lt;/summary&gt;
        internal bool EndOfGame;

        /// &lt;summary&gt;
        /// indicate the winer
        /// &lt;/summary&gt;
        internal int WinnerNum;

        /// &lt;summary&gt;
        /// Texture for the end phase button.
        /// &lt;/summary&gt;
        private Texture2D endphasebutton;

        /// &lt;summary&gt;
        /// mouse x coordinat.
        /// &lt;/summary&gt;
        private int mouseX;

        /// &lt;summary&gt;
        /// mouse y coordinat.
        /// &lt;/summary&gt;
        private int mouseY;

        /// &lt;summary&gt;
        /// The playing table.
        /// &lt;/summary&gt;
        private Texture2D table;

        /// &lt;summary&gt;
        /// The spritefont for writing standart text outputs.
        /// &lt;/summary&gt;
        private SpriteFont font;

        /// &lt;summary&gt;
        /// The spritefont for the endgame text &quot;slidly&quot; bigger than normal text.
        /// &lt;/summary&gt;
        private SpriteFont fontWin;

        /// &lt;summary&gt;
        /// The spritebatch used.
        /// &lt;/summary&gt;
        private SpriteBatch spriteBatch;

        /// &lt;summary&gt;
        /// The cursor.
        /// &lt;/summary&gt;
        private Texture2D cursor;

        /// &lt;summary&gt;
        /// The current state of the mouse.
        /// &lt;/summary&gt;
        private MouseState currentMouseState;

        /// &lt;summary&gt;
        /// last state of the mouse.
        /// &lt;/summary&gt;
        private MouseState lastMouseState;

        /// &lt;summary&gt;
        /// The startup value
        /// &lt;/summary&gt;
        private bool startUp;

        #endregion

        /// &lt;summary&gt;
        /// Initializes a new instance of the &lt;see cref=&quot;GameClass&quot;/&gt; class.
        /// &lt;/summary&gt;
        public GameClass()
        {
            this.HandZone = new HandZone();
            this.ActionZone = new ActionZone();
            this.DiscardZone = new DiscardZone();
            this.DeckZone = new DeckZone();
            this.SupplyZone = new SupplyZone();
            graphics = new GraphicsDeviceManager(this) { PreferredBackBufferWidth = 1280, PreferredBackBufferHeight = 600 };
            Content.RootDirectory = &quot;Content&quot;;
        }

        /// &lt;summary&gt;
        /// event for when a card is clicked in the handzone.
        /// &lt;/summary&gt;
        internal event CardSpriteHandler HandCardClicked;

        /// &lt;summary&gt;
        /// event for when a button is clicked in the supplyzone.
        /// &lt;/summary&gt;
        internal event CardNameHandler SupplyCardClicked;

        /// &lt;summary&gt;
        /// event for when the endphase button is clicked.
        /// &lt;/summary&gt;
        internal event ClickHandler EndPhaseClicked;

        /// &lt;summary&gt;
        /// the clickerhandler.
        /// &lt;/summary&gt;
        internal event ClickHandler StartUpdate;

        /// &lt;summary&gt;
        /// LoadContent will be called once per game and is the place to load
        /// all of your content.
        /// &lt;/summary&gt;
        protected override void LoadContent()
        {
            // Create a new SpriteBatch, which can be used to draw textures.
            spriteBatch = new SpriteBatch(GraphicsDevice);

            font = Content.Load&lt;SpriteFont&gt;(&quot;Fonts\\Arial&quot;);
            fontWin = Content.Load&lt;SpriteFont&gt;(&quot;Fonts\\Winfont&quot;);
            table = Content.Load&lt;Texture2D&gt;(&quot;Pics\\Dominiontable&quot;);
            cursor = Content.Load&lt;Texture2D&gt;(&quot;Pics\\Cursor&quot;);
            endphasebutton = Content.Load&lt;Texture2D&gt;(&quot;Pics\\EndButton&quot;);
            this.Actions = 0;
            this.Buys = 0;
            this.Coins = 0;
            this.Playernum = 0;
            this.WinnerNum = 0;
            this.Turn = false;
            this.Phase = 0;
            this.EndOfGame = false;

            foreach (CardName card in Enum.GetValues(typeof(CardName)))
            {
                string content = card.ToString().ToUpper();
                string contentLocation = string.Format(&quot;Kingdom\\{0}&quot;, content);
                Texture2D cardTexture = Content.Load&lt;Texture2D&gt;(contentLocation);
                CardImages.Add(card, cardTexture);
            }

            foreach (CardName card in Enum.GetValues(typeof(CardName)))
            {
                if (card != CardName.Empty &amp; card != CardName.Backside)
                {
                    string contentLocation = string.Format(&quot;Supply\\{0}&quot;, card);
                    Texture2D cardTexture = Content.Load&lt;Texture2D&gt;(contentLocation);
                    ButtonImages.Add(card, cardTexture);
                }
            }

            Empty = new CardSprite(CardName.Empty, -1);
            Back = new CardSprite(CardName.Backside, -1);
        }

        /// &lt;summary&gt;
        /// UnloadContent will be called once per game and is the place to unload
        /// all content.
        /// &lt;/summary&gt;
        protected override void UnloadContent()
        {
        }

        /// &lt;summary&gt;
        /// Allows the game to run logic such as updating the world,
        /// checking for collisions, gathering input, and playing audio.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;gameTime&quot;&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Update(GameTime gameTime)
        {
            if (StartUpdate != null &amp; this.startUp == false)
            {
                this.startUp = true;
                StartUpdate();
            }

            lastMouseState = currentMouseState;
            currentMouseState = Mouse.GetState();

            mouseX = currentMouseState.X;
            mouseY = currentMouseState.Y;

            if (currentMouseState.LeftButton == ButtonState.Pressed &amp;&amp; lastMouseState.LeftButton == ButtonState.Released)
            {
                if (this.HandZone.IsClickWithin(mouseX, mouseY))
                {
                    HandCardClicked(this.HandZone.FindCardByMouseClick(mouseX, mouseY));
                }

                if (this.SupplyZone.IsClickWithin(mouseX, mouseY))
                {
                    SupplyCardClicked(this.SupplyZone.FindCardByMouseClick(mouseX, mouseY));
                }

                if ((mouseX &lt; 285 &amp;&amp; mouseX &gt; 185) &amp;&amp; (mouseY &lt; 370 &amp;&amp; mouseY &gt; 340))
                {
                    EndPhaseClicked();
                }
            }

            // Allows the game to exit
            if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
            {
                this.Exit();
            }

            base.Update(gameTime);
        }

        /// &lt;summary&gt;
        /// This is called when the game should draw itself.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;gameTime&quot;&gt;Provides a snapshot of timing values.&lt;/param&gt;
        protected override void Draw(GameTime gameTime)
        {
            graphics.GraphicsDevice.Clear(Color.BlanchedAlmond);
            spriteBatch.Begin();
            spriteBatch.Draw(table, Vector2.Zero, Color.White);

            this.HandZone.Draw(spriteBatch);
            this.ActionZone.Draw(spriteBatch);
            this.DiscardZone.Draw(spriteBatch);
            this.DeckZone.Draw(spriteBatch);
            this.SupplyZone.Draw(spriteBatch);
            spriteBatch.Draw(endphasebutton, new Vector2(165, 340), Color.White);
            spriteBatch.Draw(cursor, new Vector2(mouseX, mouseY), Color.White);
            spriteBatch.DrawString(font, &quot;Actions: &quot; + this.Actions.ToString(), new Vector2(400, 15), Color.RoyalBlue);
            spriteBatch.DrawString(font, &quot;Buys: &quot; + this.Buys.ToString(), new Vector2(600, 15), Color.RoyalBlue);
            spriteBatch.DrawString(font, &quot;Coins: &quot; + this.Coins.ToString(), new Vector2(800, 15), Color.RoyalBlue);
            spriteBatch.DrawString(font, &quot;Player&quot; + this.Playernum.ToString(), new Vector2(10, 32), Color.RoyalBlue);
            spriteBatch.DrawString(font, this.Turn ? &quot;Your turn   -&quot; : &quot;Not your turn  -&quot;, new Vector2(10, 10), Color.RoyalBlue);
            if (this.Phase == 0)
            {
                spriteBatch.DrawString(font, &quot;Action phase&quot;, new Vector2(163, 10), Color.RoyalBlue);
            }

            if (this.Phase == 1)
            {
                spriteBatch.DrawString(font, &quot;Buy phase&quot;, new Vector2(163, 10), Color.RoyalBlue);
            }

            if (this.EndOfGame &amp;&amp; this.Playernum == this.WinnerNum)
            {
                spriteBatch.DrawString(fontWin, &quot;YOU ARE THE WINNER \n CONGRATULATIONS&quot;, new Vector2(200, 220), Color.Red);
            }

            if (this.EndOfGame &amp;&amp; this.Playernum != this.WinnerNum)
            {
                spriteBatch.DrawString(fontWin, &quot;YOU LOSE\n NOW TAKE YOUR\n CRUSHED SOUL AND GO AWAY&quot;, new Vector2(200, 220), Color.Red);
            }

            spriteBatch.End();
            base.Draw(gameTime);
        }
    }
}</pre></code><script type="text/javascript">
			applyranges('src5', RANGES_5)
		</script>
	</body>
</html>